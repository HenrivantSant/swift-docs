<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/swift-docs/blog/rss.xml" title="Swift PHP Framework Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/swift-docs/blog/atom.xml" title="Swift PHP Framework Blog Atom Feed"><title data-react-helmet="true">Authorization | Swift PHP Framework</title><meta data-react-helmet="true" property="og:url" content="https://swiftapi.github.io/swift-docs/docs/security/authorization"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Authorization | Swift PHP Framework"><meta data-react-helmet="true" name="description" content="Authorization where is determined whether a user (clients are treated as users too) is allowed access to a certain resource/functionality."><meta data-react-helmet="true" property="og:description" content="Authorization where is determined whether a user (clients are treated as users too) is allowed access to a certain resource/functionality."><link data-react-helmet="true" rel="shortcut icon" href="/swift-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://swiftapi.github.io/swift-docs/docs/security/authorization"><link data-react-helmet="true" rel="alternate" href="https://swiftapi.github.io/swift-docs/docs/security/authorization" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://swiftapi.github.io/swift-docs/docs/security/authorization" hreflang="x-default"><link rel="stylesheet" href="/swift-docs/assets/css/styles.20fc7aa4.css">
<link rel="preload" href="/swift-docs/assets/js/styles.ed285477.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/runtime~main.8358c8df.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/main.30bd325a.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/1.7b6dc93b.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/2.b66194e9.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/1f391b9e.53b56db4.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/51.8afd32f1.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/935f2afb.c312d775.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/17896441.f1b86b90.js" as="script">
<link rel="preload" href="/swift-docs/assets/js/993f72ea.b63002f0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/swift-docs/"><img src="/swift-docs/img/logo.svg" alt="Swift Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/swift-docs/img/logo.svg" alt="Swift Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Swift</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/swift-docs/docs/">Docs</a><a class="navbar__item navbar__link" href="/swift-docs/blog">Blog</a><a class="navbar__item navbar__link" href="/swift-docs/next">Next</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SwiftAPI/swift" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/swift-docs/"><img src="/swift-docs/img/logo.svg" alt="Swift Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/swift-docs/img/logo.svg" alt="Swift Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Swift</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/swift-docs/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/next">Next</a></li><li class="menu__list-item"><a href="https://github.com/SwiftAPI/swift" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/swift-docs/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/swift-docs/docs/getting-started/installation">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/application-lifecycle">Application lifecycle</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/attributes">Attributes</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/command-line-interface">Command line interface</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/configuration">Configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Database layer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/swift-docs/docs/database/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/swift-docs/docs/database/driver">Driver</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/swift-docs/docs/database/entities">Entities</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/dependency-injection">Dependency Injection</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/events-and-subscribers">Events, Subscribers &amp; Listeners</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/graphql">GraphQL</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/httpfoundation">HTTP Foundation</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/logging">Logging</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/making-requests">Making requests</a></li><li class="menu__list-item"><a class="menu__link" href="/swift-docs/docs/routing-and-controllers">Routing &amp; Controllers</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/swift-docs/docs/security/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/swift-docs/docs/security/authentication">Authentication</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/swift-docs/docs/security/authorization">Authorization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/swift-docs/docs/security/users">Users (&amp; Clients)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/swift-docs/docs/security/firewall">Firewall</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Authorization</h1></header><div class="markdown"><p>Authorization where is determined whether a user (clients are treated as users too) is allowed access to a certain resource/functionality.</p><p>Most commonly this happens based on a User Role or Authentication Status (Authenticated/Not Authenticated). Also it&#x27;s quite common to validate whether a User or a Client is requesting a resource.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="voters"></a>Voters<a class="hash-link" href="#voters" title="Direct link to heading">#</a></h2><p>To determine whether access is granted system of Voters is used. Voters should implement the VoterInterface. All voters are automatically registered in the AccessDecisionManager. The AccessDecisionManager will ask all voters to vote on the provided subject. A voter can return three possible answers:</p><ul><li>ACCESS_GRANTED</li><li>ACCESS_DENIED</li><li>ACCESS_ABSTAIN</li></ul><p>Abstain is relevant when the voter has no possible answer. E.g. the Authenticated Voter has no clue when there&#x27;s asked for a vote on a User Role. In this case the voter would abstain from voting.</p><p>The component comes with default Voters on User Roles and User Authentication. No need to write custom Voters on this subject if you&#x27;re not adding major extended functionality in that area.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">declare(strict_types=1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Swift\Security\Authorization\Voter;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Swift\Kernel\Attributes\DI;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Swift\Security\Authentication\Token\TokenInterface;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Swift\Security\Authorization\DiTags;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Class VoterInterface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @package Swift\Security\Authorization\Voter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[DI(tags: [DiTags::SECURITY_AUTHORIZATION_VOTER])]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface VoterInterface {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ACCESS_GRANTED = &#x27;ACCESS_GRANTED&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ACCESS_DENIED = &#x27;ACCESS_DENIED&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ACCESS_ABSTAIN = &#x27;ACCESS_ABSTAIN&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * Vote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param TokenInterface $token</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param mixed $subject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param array $attributes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @return string ACCESS_GRANTED || ACCESS_DENIED || ACCESS_ABSTAIN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function vote( TokenInterface $token, mixed $subject, array $attributes ): string;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="user-role-voter"></a>User Role Voter<a class="hash-link" href="#user-role-voter" title="Direct link to heading">#</a></h3><p>User Role Voter confirms whether a user has a certain role. Do not use Swift\Security\User\UserInterface::getRoles() to determine whether the user has a certain role as this only return the directly assigned roles. Roles can be related with each other or have a certain hierarchy. There are some default options:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">declare(strict_types=1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Swift\Security\Authorization;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Swift\Kernel\TypeSystem\Enum;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Class AuthorizationRolesEnum</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @package Swift\Security\Authorization</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class AuthorizationRolesEnum extends Enum {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Main roles</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ROLE_GUEST = &#x27;ROLE_GUEST&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ROLE_USER = &#x27;ROLE_USER&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ROLE_CLIENT = &#x27;ROLE_CLIENT&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ROLE_ADMIN = &#x27;ROLE_ADMIN&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ROLE_SUPER_ADMIN = &#x27;ROLE_SUPER_ADMIN&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Sub roles</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const ROLE_USERS_LIST = &#x27;ROLE_USERS_LIST&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="authenticated-voter"></a>Authenticated Voter<a class="hash-link" href="#authenticated-voter" title="Direct link to heading">#</a></h3><p>The Authenticated voter determines whether the current user or client has authenticated, but also how it authenticated. This are the options:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">declare(strict_types=1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Swift\Security\Authorization;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Swift\Kernel\TypeSystem\Enum;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Class AuthorizationTypesEnum</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @package Swift\Security\Authorization</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class AuthorizationTypesEnum extends Enum {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const IS_AUTHENTICATED = &#x27;IS_AUTHENTICATED&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const IS_AUTHENTICATED_DIRECTLY = &#x27;IS_AUTHENTICATED_DIRECTLY&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const IS_AUTHENTICATED_ANONYMOUSLY = &#x27;IS_AUTHENTICATED_ANONYMOUSLY&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const IS_AUTHENTICATED_TOKEN = &#x27;IS_AUTHENTICATED_TOKEN&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public const PUBLIC_ACCESS = &#x27;PUBLIC_ACCESS&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="custom-voter"></a>Custom Voter<a class="hash-link" href="#custom-voter" title="Direct link to heading">#</a></h3><p>To create a custom voter simply implement the <code>Swift\Security\Authorization\Voter\VoterInterface</code>. This Interface is pre-tagged and will automatically register in the AccessDecisionManager. </p><p>Note: Make sure to return ACCESS_ABSTAIN if no vote could be made!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="strategies"></a>Strategies<a class="hash-link" href="#strategies" title="Direct link to heading">#</a></h2><p>By default there&#x27;s four possible strategies on voting.</p><ul><li><code>Swift\Security\Authorization\Strategy\AffirmativeDecisionStrategy</code><br>Grants access if any voter returns an affirmative response</li><li><code>Swift\Security\Authorization\Strategy\ConsensusDecisionStrategy</code><br>Grants access if there is consensus of granted against denied responses.<br>Consensus means majority-rule (ignoring abstains) rather than unanimous agreement (ignoring abstains).</li><li><code>Swift\Security\Authorization\Strategy\PriorityDecisionStrategy</code><br>Grant or deny access depending on the first voter that does not abstain.<br>The priority of voters can be used to overrule a decision.</li><li><code>Swift\Security\Authorization\Strategy\UnanimousDecisionStrategy</code><br>Grants access if only grant (ignoring abstain) votes were received.</li></ul><p>What if all voters abstain from voting? By default access is denied when all voters abstain from voting. The can be overruled in the configuration.</p><p>The default strategy is <code>Swift\Security\Authorization\Strategy\AffirmativeDecisionStrategy</code>. This can be overruled on the configuration.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="custom-strategy"></a>Custom strategy<a class="hash-link" href="#custom-strategy" title="Direct link to heading">#</a></h3><p>Easily create your own strategy by implementing the <code>Swift\Security\Authorization\Strategy\DecisionStrategyInterface</code>. The Interface is pre-tagged and will automatically register the Strategy. To use it as default set it as default in the Security Configuration.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="roles"></a>Roles<a class="hash-link" href="#roles" title="Direct link to heading">#</a></h2><p>Roles are used to represent the users authenticity and what the user is allowed to do. Roles can be defined in the configuration as below. The roles in de example below are already present by default. Custom Roles can be added. A role will automatically also have all it&#x27;s child roles. So ROLE_CLIENT will also have ROLE_USERS_LIST. To take it a step further, ROLE_SUPER_ADMIN will also have ROLE_ADMIN and therefore also ROLE_USERS_LIST. See how this works now?</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="assign-role-to-authenticated-user"></a>Assign role to authenticated user<a class="hash-link" href="#assign-role-to-authenticated-user" title="Direct link to heading">#</a></h3><p>Now it&#x27;s highly possible you&#x27;d want to assign a user more rights or validate the given rights of a user once it authenticates.</p><p>The proper way to do this is to listen to the authentication events and add/remove the appropriate roles.</p><p>Most appropriate events:</p><ul><li><code>Swift\Security\Authentication\Events\AuthenticationTokenCreatedEvent</code><br>Token has been created, user authentication is not validated yet</li><li><code>Swift\Security\Authentication\Events\AuthenticationSuccessEvent</code><br>Token has been created, authentication is successful. This usually makes the most sense.</li></ul><p><em>Example</em></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Listen to AuthenticationSuccessEvent callback and add/remove roles accordingly</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @param AuthenticationSuccessEvent $event</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[ListenTo(event: AuthenticationSuccessEvent::class)]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public function onAuthenticationFinished( AuthenticationSuccessEvent $event ): void {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Example where user with id 3 should have an extra role</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($event-&gt;getToken()-&gt;getUser()-&gt;getId() === 3) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $event-&gt;getToken()-&gt;getUser()-&gt;getRoles()-&gt;set(&#x27;ROLE_USER_DEMO&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Example where user with id 4 should not have given role</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if ($event-&gt;getToken()-&gt;getUser()-&gt;getId() === 4) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        $event-&gt;getToken()-&gt;getUser()-&gt;getRoles()-&gt;remove(&#x27;ROLE_USER_DEMO&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><p>Security configuration happens through separate configuration file /etc/security.yaml. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">enable_firewalls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">firewalls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># limit login attempts, defaults to 5 per minute. Set to 0 to disable throttling</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">login_throttling</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">max_attempts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">role_hierarchy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ROLE_GUEST</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ROLE_USER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ROLE_CLIENT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ROLE_USERS_LIST&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ROLE_ADMIN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ROLE_USERS_LIST&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ROLE_SUPER_ADMIN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ROLE_ADMIN&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">access_decision_manager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">strategy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Swift\Security\Authorization\Strategy\AffirmativeDecisionStrategy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">allow_if_all_abstain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">access_control</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="usage"></a>Usage<a class="hash-link" href="#usage" title="Direct link to heading">#</a></h2><p>Authorization validation is presented through a simple interface called the AuthorizationChecker. It comes with two methods.</p><p>Inject it with <code>Swift\Security\Authorization\AuthorizationCheckerInterface $authorizationChecker</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">declare(strict_types=1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace Swift\Security\Authorization;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">use Swift\HttpFoundation\Exception\AccessDeniedException;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Interface AuthorizationCheckerInterface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @package Swift\Security\Authorization</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface AuthorizationCheckerInterface {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * Validate whether given subject should be available</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param array $attributes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param mixed $subject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param string|null $strategy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @return bool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function isGranted( array $attributes, mixed $subject = null, string $strategy = null ): bool;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * Validate whether given subject should be available</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * Throw exception when not granted</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param array $attributes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param mixed $subject</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @param string|null $strategy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @return void</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     * @throws AccessDeniedException</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public function denyUnlessGranted( array $attributes, mixed $subject = null, string $strategy = null ): void;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-use"></a>How to use<a class="hash-link" href="#how-to-use" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Returns a boolean (true on granted, false on not granted)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$this-&gt;authorizationChecker-&gt;isGranted([AuthorizationRolesEnum::ROLE_CLIENT]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Throws Swift\HttpFoundation\Exception\AccessDeniedException when not granted.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$this-&gt;authorizationChecker-&gt;denyUnlessGranted([AuthorizationRolesEnum::ROLE_CLIENT]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="controller-shortcuts"></a>Controller shortcuts<a class="hash-link" href="#controller-shortcuts" title="Direct link to heading">#</a></h2><p>Controllers are equipped with some handy shortcuts. In a Controller you can directly call <code>$this-&gt;denyAccessUnlessGranted()</code>.</p><p>However even more useful for REST endpoints is the isGranted parameter on the Route Attribute. Below an example of the &#x27;/users/me/&#x27; endpoint.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Return currently authenticated user. For this it is required that a user is authenticated</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @param RouteParameter[] $params</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * @return JsonResponse</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[Route( method: RouteMethodEnum::GET, route: &#x27;/me/&#x27;, name: &#x27;security.users.me&#x27;, isGranted: [AuthorizationTypesEnum::IS_AUTHENTICATED] )]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public function me( array $params ): JsonResponse {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $data = $this-&gt;getCurrentUser()-&gt;serialize();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unset($data-&gt;password);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return new JsonResponse($data);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/SwiftAPI/swift-docs/tree/master/docs/security/authorization.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/swift-docs/docs/security/authentication"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Authentication</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/swift-docs/docs/security/users"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Users (&amp; Clients) Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#voters" class="table-of-contents__link">Voters</a><ul><li><a href="#user-role-voter" class="table-of-contents__link">User Role Voter</a></li><li><a href="#authenticated-voter" class="table-of-contents__link">Authenticated Voter</a></li><li><a href="#custom-voter" class="table-of-contents__link">Custom Voter</a></li></ul></li><li><a href="#strategies" class="table-of-contents__link">Strategies</a><ul><li><a href="#custom-strategy" class="table-of-contents__link">Custom strategy</a></li></ul></li><li><a href="#roles" class="table-of-contents__link">Roles</a><ul><li><a href="#assign-role-to-authenticated-user" class="table-of-contents__link">Assign role to authenticated user</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li><li><a href="#usage" class="table-of-contents__link">Usage</a></li><li><a href="#controller-shortcuts" class="table-of-contents__link">Controller shortcuts</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/swift-docs/docs/">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/swift-api" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/swift-docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/SwiftAPI/swift" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Swift. Built with Docusaurus.</div></div></div></footer></div>
<script src="/swift-docs/assets/js/styles.ed285477.js"></script>
<script src="/swift-docs/assets/js/runtime~main.8358c8df.js"></script>
<script src="/swift-docs/assets/js/main.30bd325a.js"></script>
<script src="/swift-docs/assets/js/1.7b6dc93b.js"></script>
<script src="/swift-docs/assets/js/2.b66194e9.js"></script>
<script src="/swift-docs/assets/js/1f391b9e.53b56db4.js"></script>
<script src="/swift-docs/assets/js/51.8afd32f1.js"></script>
<script src="/swift-docs/assets/js/935f2afb.c312d775.js"></script>
<script src="/swift-docs/assets/js/17896441.f1b86b90.js"></script>
<script src="/swift-docs/assets/js/993f72ea.b63002f0.js"></script>
</body>
</html>